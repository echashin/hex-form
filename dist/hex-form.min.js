"use strict";this.HexWidget=function(){function t(t){function e(t){void 0!==t.input&&(r=t.input,n=r.closest(".form-group").find("button.password-show"),n.bind("click",function(t){return t.preventDefault(),"password"===a?(r.attr("type","text"),n.addClass("active"),a="text"):(r.attr("type","password"),n.removeClass("active"),a="password"),r.focus(),!1}))}var n,r,a="password";e(t)}function e(t){function e(t){return s=t.length>8?1:0,u=t.match(d)?1:0,c=t.match(f)?1:0,v=t.match(p)?1:0,l=t.match(h)?1:0,s+u+c+v+l}function n(t){void 0!==t.events&&i.setEvents(t.events),void 0!==t.input&&(r=t.input,a=r.closest(".form-group").find(".password-strength div"),r.bind("keyup change",function(){var t=r.val();a.attr("class","s-"+e(t))}))}var r,a,i=this,o=["change"],s=0,u=0,c=0,v=0,l=0,d=new RegExp("[A-ZА-Я]"),f=new RegExp("[a-zа-я]"),p=new RegExp("[0-9]"),h=new RegExp("([!,%,&,@,#,$,^,*,?,_,~])");i.weight=0,i.setEvents=function(t){o=t},i.getEvents=function(){return o},n(t)}function n(t){function e(t){if(void 0!==t.input){n=t.input;var e=moment.localeData(),r={autoUpdateInput:!1,linkedCalendars:!1,singleDatePicker:!0,locale:{format:e.longDateFormat("L"),separator:" - ",applyLabel:"Готово",cancelLabel:"Отмена",fromLabel:"От",toLabel:"До",customRangeLabel:"Custom",daysOfWeek:moment.weekdaysShort(),monthNames:moment.months(),firstDay:e.firstDayOfWeek()}};$.extend(r,t);var a=r.locale.format.replace(/[D]+/g,"d").replace(/[M]+/g,"m").replace(/[Y]+/g,"y");r.singleDatePicker===!1&&(a+=r.locale.separator+a),n.inputmask(a),n.daterangepicker(r,function(t,e){var a=t.format(r.locale.format);r.singleDatePicker===!1&&(a+=r.locale.separator+e.format(r.locale.format)),n.val(a),n.trigger("blur")})}}var n;e(t)}function r(t){function e(t){void 0!==t.input&&(n=t.input,n.inputmask("+7(999)999-99-99"))}var n;e(t)}function a(a){function i(a){switch(a.type){case"password-strength":return new e(a);case"password-show":return new t(a);case"date":return new n(a);case"phone":return new r(a);default:throw new Error("Unfinded widget: "+a.type)}}return i(a)}return a}(),this.HexValidator=function(){function t(t){function e(t){void 0!==t.events&&n.setEvents(t.events)}var n=this,r=["blur"];n.weight=0;var a="required";n.getClassName=function(){return a},n.setEvents=function(t){r=t},n.getEvents=function(){return r},n.isValid=function(t){return t===!1||void 0===t||""===t?!1:!0},e(t)}function e(t){function e(t){void 0!==t.events&&n.setEvents(t.events),void 0!==t.input&&(a=t.input)}var n=this,r=["change","keyup","blur"];n.weight=3;var a,i="date";n.getClassName=function(){return i},n.setEvents=function(t){r=t},n.getEvents=function(){return r},n.isValid=function(){var t=a.inputmask("option","mask");return Inputmask.isValid(a.val(),{alias:t})},e(t)}function n(t){function e(t){void 0!==t.events&&n.setEvents(t.events)}var n=this,r="email";n.getClassName=function(){return r};var a=["change","keyup"],i=/^\S+[@]\S+\.\S{2,10}$/i;n.weight=1,n.setEvents=function(t){a=t},n.getEvents=function(){return a},n.isValid=function(t){return i.test(t)},e(t)}function r(t){function e(t){void 0!==t.events&&n.setEvents(t.events),void 0!==t.url&&(a=t.url)}var n=this,r="unique";n.getClassName=function(){return r};var a,i=!1,o=!1,s=["change","keyup","blur"];n.weight=5,n.setEvents=function(t){s=t},n.getEvents=function(){return s},n.isValid=function(t){if(o!==!1&&o.abort(),i!==t){o=$.ajax({url:a,data:{value:t},method:"POST",async:!1});var e=o.responseText;return i="true"===e?t:!1,e}return!0},e(t)}function a(t){function e(t){void 0!==t.events&&r.setEvents(t.events),void 0!==t.input&&(n=t.input)}var n,r=this,a="phone",i=["blur"];r.getClassName=function(){return a},r.weight=4,r.setEvents=function(t){i=t},r.getEvents=function(){return i},r.isValid=function(){var t=n.inputmask("option","mask");return Inputmask.isValid(n.val(),{alias:t})},e(t)}function i(t){function e(t){void 0!==t.min&&(n=t.min),void 0!==t.max&&(r=t.max),void 0!==t.events&&a.setEvents(t.events)}var n,r,a=this,i="string-length";a.getClassName=function(){return i};var o=["change","keyup","blur"];a.weight=3,a.setEvents=function(t){o=t},a.getEvents=function(){return o},a.isValid=function(t){var e=t.length;return void 0!==n&&n>e?(i="string-length-min",!1):void 0!==r&&e>r?(i="string-length-max",!1):!0},e(t)}function o(t){function e(t){void 0!==t.events&&n.setEvents(t.events),void 0!==t.password&&(i=$(t.password))}var n=this,r="password-confirm";n.getClassName=function(){return r};var a=["change","keyup","blur"];n.weight=4;var i;n.setEvents=function(t){a=t},n.getEvents=function(){return a},n.isValid=function(t){return i.val()===t},e(t)}function s(s){function u(s){switch(s.type){case"required":return new t(s);case"email":return new n(s);case"unique":return new r(s);case"password-confirm":return new o(s);case"string-length":return new i(s);case"date":return new e(s);case"phone":return new a(s);default:throw new Error("Unfinded validator: "+s.type)}}return u(s)}return s}(),this.hexForm=function(){function t(t){var e=this;e.type=void 0,e.valid=!0,e.name=void 0;var n,r,a,i,o=[],s=t.form;e.tabPanel=void 0;var u=[],c={},v={},l=function(t){return function(e,n){return"number"==typeof e[t]?e[t]-n[t]:e[t]<n[t]?-1:e[t]>n[t]?1:0}},d=function(){var t=0;r.find("span").removeClass("active");for(var i in u)if(u.hasOwnProperty(i)){var o=u[i],c=e.getValue(),v=o.isValid(c);if(v===!1||"false"===v){t++,r.find("span.error-"+o.getClassName()).addClass("active");break}}if(t>0?(e.valid=!1,a.addClass("has-error")):(a.removeClass("has-error"),e.valid=!0),void 0!==n){var l=!0;for(var d in s.controls)if(s.controls.hasOwnProperty(d)){var f=s.controls[d];if(f.tabPanel===e.tabPanel&&f.valid===!1){l=!1;break}}l===!0?n.removeClass("has-error"):n.addClass("has-error")}return e.valid};e.validate=function(t){return void 0===t?d():"blur"===t.type?d():(void 0!==i&&clearTimeout(i),void(i=setTimeout(d,500)))},e.trigger=function(t){for(var e=0;e<o.length;e++)o[e].trigger(t)};var f=function(t){for(var e={},n=t[0].attributes,r=n.length,a=0;r>a;a++)e[n[a].name.toLowerCase()]=n[a].value;return e},p=function(t,e,n){var r={input:n,type:t};void 0!==e&&""!==e&&$.extend(r,jQuery.parseJSON(e));var a=new HexValidator(r),i=a.getEvents();for(var o in i)i.hasOwnProperty(o)&&(v[i[o]]=!0);u.push(a)},h=function(t,e,n){var r={input:n,type:t};void 0!==e&&""!==e&&$.extend(r,jQuery.parseJSON(e)),c[t]=new HexWidget(r)};e.addInput=function(t){o.push(t);var n=f(t);for(var r in n)if(n.hasOwnProperty(r)){if("required"===r)p("required",n[r],t);else{var a=r.match(/^data-hex-validator-(.*)$/i);null!==a&&void 0!==a[1]&&p(a[1],n[r],t)}var i=r.match(/^data-hex-widget-(.*)$/i);null!==i&&void 0!==i[1]&&h(i[1],n[r],t)}for(var s in v)v.hasOwnProperty(s)&&t.bind(s,e.validate);u.sort(l("weight"))},e.getValue=function(){switch(e.type){case"text":default:if(void 0!==c.date){var t=o[0].data("daterangepicker");if(void 0===t)return o[0].val();if(""===o[0].val())return!1;var n="";if(n+=t.startDate.format("YYYY-MM-DD"),t.singleDatePicker===!1){var r=t.endDate.format("YYYY-MM-DD");n+=" - "+r}return n}return o[0].val();case"radio":for(var a in o)if(o.hasOwnProperty(a)&&o[a].is(":checked")===!0)return o[a].val();return!1;case"checkbox":return o[0].is(":checked")===!0?e.trueValue:e.falseValue}};var m=function(t){if(void 0!==t.type&&(e.type=t.type,"checkbox"===t.type&&(e.trueValue=!0,e.falseValue=!1)),void 0!==t.form&&(s=t.form),e.name=t.name,void 0!==t.inputs)for(var i in t.inputs)t.inputs.hasOwnProperty(i)&&e.addInput(t.inputs[i]);if(a=o[0].closest("div.form-group"),r=a.find(".errors"),e.tabPanel=o[0].closest(".tab-pane"),e.tabPanel.size()>0){var u=e.tabPanel.attr("id"),c=$('.nav a[href="#'+u+'"]');c.size()>0&&(n=c)}};m(t)}function e(e){var n=this;n.controls=[];var r=e,a=function(){$.each(r.find('input[type!="submit"],select,textarea'),function(e,r){var a=$(r),i=a.prop("tagName").toLowerCase();switch(i){case"textarea":n.controls.push(new t({type:"textarea",inputs:[a],form:n,name:a.attr("name")}));break;case"select":n.controls.push(new t({type:"select",inputs:[a],form:n,name:a.attr("name")}));break;case"input":var o=a.attr("type").toLowerCase();switch(o){default:n.controls.push(new t({type:o,inputs:[a],form:n,name:a.attr("name")}));break;case"checkbox":var s=new t({type:"checkbox",inputs:[a],form:n,name:a.attr("name")});void 0!==a.attr("value")&&(s.trueValue=a.attr("value")),void 0!==a.attr("data-hex-true-value")&&(s.trueValue=a.attr("data-hex-true-value")),void 0!==a.attr("data-hex-false-value")&&(s.falseValue=a.attr("data-hex-false-value")),n.controls.push(s);break;case"radio":void 0===n.controls[a.attr("name")]?n.controls[a.attr("name")]=new t({type:"radio",inputs:[a],form:n,name:a.attr("name")}):n.controls[a.attr("name")].addInput(a)}}})},i=function(){var t={};for(var e in n.controls)if(n.controls.hasOwnProperty(e)){var r=n.controls[e].name;t[r]=n.controls[e].getValue()}return t},o=function(){window.setTimeout(function(){for(var t in n.controls)n.controls.hasOwnProperty(t)&&n.controls[t].trigger("change")},1)},s=function(){r.find(".has-error").removeClass("has-error"),r.find(".alerts div").remove(),r.find(".messages div").remove(),r.find(".errors .active").removeClass("active")},u=function(t){t.preventDefault();var e=!0;for(var a in n.controls)n.controls.hasOwnProperty(a)&&n.controls[a].validate(void 0)===!1&&(e=!1);if(e===!0){var o=i(),u=r.attr("action");s();var c=r.find("button[type=submit]:focus");c.size()>0&&void 0!==c.attr("data-action")&&(u=c.attr("data-action")),$.ajax({url:u,data:o,type:"POST",dataType:"json",success:function(t){if(t.success===!0){if(s(),void 0!==t.reload&&(t.reload===!0?window.location.href=window.location.href:window.location.href=t.reload),void 0!==t.alerts)for(var e in t.alerts)r.find(".messages").append($("<div>").html(t.alerts[e]))}else if(void 0!==t.alerts)for(var n in t.alerts)r.find(".alerts").append($("<div>").html(t.alerts[n]))},error:function(t,e,n){console.log(e,n)}})}return!1};n.submit=function(){u()},n.getValues=function(){return i()};var c=function(){r.addClass("loader-container").append('<div class="loader"></div>'),r.bind("submit",u),r.bind("reset",o),a()};return c(),n}function n(t){if(void 0!==t)return r[t];var n=$("form.hex-form");return n.each(function(){var t=$(this).attr("id");if(void 0===t)throw new Error("Form dont have id attr");r[t]=new e($(this))}),r}var r={};return n}();