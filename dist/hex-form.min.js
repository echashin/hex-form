var hex=function(){"use strict";var e={widgets:{},validators:{},utils:{}};return e.utils.toCamel=function(e){return e.replace(/[-_]([a-z])/g,function(e){return e[1].toUpperCase()})},e.utils.isEmpty=function(e){return!!(null===e||e===!1||void 0===e||""===e||$.isArray(e)&&0===e.length)},e.utils.md5=function(e){function t(e,t){return e<<t|e>>>32-t}function r(e,t){var r,n,a,i,o;return a=2147483648&e,i=2147483648&t,r=1073741824&e,n=1073741824&t,o=(1073741823&e)+(1073741823&t),r&n?2147483648^o^a^i:r|n?1073741824&o?3221225472^o^a^i:1073741824^o^a^i:o^a^i}function n(e,t,r){return e&t|~e&r}function a(e,t,r){return e&r|t&~r}function i(e,t,r){return e^t^r}function o(e,t,r){return t^(e|~r)}function s(e,a,i,o,s,d,u){return e=r(e,r(r(n(a,i,o),s),u)),r(t(e,d),a)}function d(e,n,i,o,s,d,u){return e=r(e,r(r(a(n,i,o),s),u)),r(t(e,d),n)}function u(e,n,a,o,s,d,u){return e=r(e,r(r(i(n,a,o),s),u)),r(t(e,d),n)}function l(e,n,a,i,s,d,u){return e=r(e,r(r(o(n,a,i),s),u)),r(t(e,d),n)}function c(e){for(var t,r=e.length,n=r+8,a=(n-n%64)/64,i=16*(a+1),o=Array(i-1),s=0,d=0;r>d;)t=(d-d%4)/4,s=d%4*8,o[t]=o[t]|e.charCodeAt(d)<<s,d++;return t=(d-d%4)/4,s=d%4*8,o[t]=o[t]|128<<s,o[i-2]=r<<3,o[i-1]=r>>>29,o}function f(e){var t,r,n="",a="";for(r=0;3>=r;r++)t=e>>>8*r&255,a="0"+t.toString(16),n+=a.substr(a.length-2,2);return n}function v(e){e=e.replace(/\r\n/g,"\n");for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r);128>n?t+=String.fromCharCode(n):n>127&&2048>n?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t}var h,p,m,g,x,y,b,k,w,C=[],E=7,$=12,B=17,V=22,D=5,S=9,I=14,O=20,z=4,P=11,N=16,M=23,T=6,R=10,j=15,F=21;for(e=v(e),C=c(e),y=1732584193,b=4023233417,k=2562383102,w=271733878,h=0;h<C.length;h+=16)p=y,m=b,g=k,x=w,y=s(y,b,k,w,C[h+0],E,3614090360),w=s(w,y,b,k,C[h+1],$,3905402710),k=s(k,w,y,b,C[h+2],B,606105819),b=s(b,k,w,y,C[h+3],V,3250441966),y=s(y,b,k,w,C[h+4],E,4118548399),w=s(w,y,b,k,C[h+5],$,1200080426),k=s(k,w,y,b,C[h+6],B,2821735955),b=s(b,k,w,y,C[h+7],V,4249261313),y=s(y,b,k,w,C[h+8],E,1770035416),w=s(w,y,b,k,C[h+9],$,2336552879),k=s(k,w,y,b,C[h+10],B,4294925233),b=s(b,k,w,y,C[h+11],V,2304563134),y=s(y,b,k,w,C[h+12],E,1804603682),w=s(w,y,b,k,C[h+13],$,4254626195),k=s(k,w,y,b,C[h+14],B,2792965006),b=s(b,k,w,y,C[h+15],V,1236535329),y=d(y,b,k,w,C[h+1],D,4129170786),w=d(w,y,b,k,C[h+6],S,3225465664),k=d(k,w,y,b,C[h+11],I,643717713),b=d(b,k,w,y,C[h+0],O,3921069994),y=d(y,b,k,w,C[h+5],D,3593408605),w=d(w,y,b,k,C[h+10],S,38016083),k=d(k,w,y,b,C[h+15],I,3634488961),b=d(b,k,w,y,C[h+4],O,3889429448),y=d(y,b,k,w,C[h+9],D,568446438),w=d(w,y,b,k,C[h+14],S,3275163606),k=d(k,w,y,b,C[h+3],I,4107603335),b=d(b,k,w,y,C[h+8],O,1163531501),y=d(y,b,k,w,C[h+13],D,2850285829),w=d(w,y,b,k,C[h+2],S,4243563512),k=d(k,w,y,b,C[h+7],I,1735328473),b=d(b,k,w,y,C[h+12],O,2368359562),y=u(y,b,k,w,C[h+5],z,4294588738),w=u(w,y,b,k,C[h+8],P,2272392833),k=u(k,w,y,b,C[h+11],N,1839030562),b=u(b,k,w,y,C[h+14],M,4259657740),y=u(y,b,k,w,C[h+1],z,2763975236),w=u(w,y,b,k,C[h+4],P,1272893353),k=u(k,w,y,b,C[h+7],N,4139469664),b=u(b,k,w,y,C[h+10],M,3200236656),y=u(y,b,k,w,C[h+13],z,681279174),w=u(w,y,b,k,C[h+0],P,3936430074),k=u(k,w,y,b,C[h+3],N,3572445317),b=u(b,k,w,y,C[h+6],M,76029189),y=u(y,b,k,w,C[h+9],z,3654602809),w=u(w,y,b,k,C[h+12],P,3873151461),k=u(k,w,y,b,C[h+15],N,530742520),b=u(b,k,w,y,C[h+2],M,3299628645),y=l(y,b,k,w,C[h+0],T,4096336452),w=l(w,y,b,k,C[h+7],R,1126891415),k=l(k,w,y,b,C[h+14],j,2878612391),b=l(b,k,w,y,C[h+5],F,4237533241),y=l(y,b,k,w,C[h+12],T,1700485571),w=l(w,y,b,k,C[h+3],R,2399980690),k=l(k,w,y,b,C[h+10],j,4293915773),b=l(b,k,w,y,C[h+1],F,2240044497),y=l(y,b,k,w,C[h+8],T,1873313359),w=l(w,y,b,k,C[h+15],R,4264355552),k=l(k,w,y,b,C[h+6],j,2734768916),b=l(b,k,w,y,C[h+13],F,1309151649),y=l(y,b,k,w,C[h+4],T,4149444226),w=l(w,y,b,k,C[h+11],R,3174756917),k=l(k,w,y,b,C[h+2],j,718787259),b=l(b,k,w,y,C[h+9],F,3951481745),y=r(y,p),b=r(b,m),k=r(k,g),w=r(w,x);var L=f(y)+f(b)+f(k)+f(w);return L.toLowerCase()},e}(),hex=function(e){"use strict";return e.Block=function(t,r,n){function a(){var e=[],r={};t.find('input[type!="submit"],select,textarea').each(function(){var t=$(this),r=t.parents('[data-hex-block][data-hex-multy-item!="$"]:first').attr("id");r===o.id&&e.push(t)}),t.find('[data-hex-block][data-hex-multy-item!="$"]').each(function(){var e=$(this);e.parents('[data-hex-block][data-hex-multy-item!="$"]:first').attr("id")===o.id&&(r[e.attr("id")]=e)});for(var n in r)o.addBlock(r[n]);d(e)}function i(){if(o.id=t.attr("id"),o.form=r,o.element=t,o.parent=n,$('[href="#'+o.id+'"]').size()>0&&(s=$('[href="#'+o.id+'"]')),void 0===o.id)throw new Error("[data-hex-block] must have id attr");a()}var o=this;o.element=void 0,o.childBlocks=[],o.controls=[],o.parent=void 0;var s;o.id=void 0,o.valid=!0,o.form=void 0,o.hideErrors=function(){void 0!==s&&s.removeClass("has-error")},o.findBlockById=function(e){if(o.id===e)return o;for(var t in o.childBlocks){var r=o.childBlocks[t].findBlockById(e);if(r!==!1)return r}return!1},o.addBlock=function(t){o.childBlocks.push(new e.Block(t,r,o))},o.showErrors=function(){void 0!==s&&s.addClass("has-error")},o.isValid=function(e){var t=!0;for(var r in o.controls)o.controls[r].isValid(e)||(t=!1);for(var n in o.childBlocks)o.childBlocks[n].isValid(e)||(t=!1);return o.valid=t,void 0!==s&&(t?s.removeClass("has-error"):o.showErrors()),o.valid},o.setValid=function(){},o.getValues=function(){};var d=function(e){var t={};for(var r in e){var n=e[r];if(n.parents('[data-hex-multy-item="$"]').size()<=0){var a,i=n.attr("name"),s=n.closest(".form-group");s.size()<=0?s=void 0:(a=s.find(".errors"),a.size()<=0&&(a=void 0));var d=n.prop("tagName").toLowerCase(),u=d,l={type:u,inputs:[n],formGroup:s,errorsBlock:a,block:o,name:i};switch(d){case"select":case"textarea":break;case"input":switch(u=n.attr("type").toLowerCase()){default:l.type=u;break;case"checkbox":u="checkbox",l.type=u,void 0!==n.attr("value")&&(l.trueValue=n.attr("value")),void 0!==n.attr("data-hex-true-value")&&(l.trueValue=n.attr("data-hex-true-value")),void 0!==n.attr("data-hex-false-value")&&(l.falseValue=n.attr("data-hex-false-value"));break;case"radio":l.type="radio"}}void 0===t[i]?t[i]=l:t[i].inputs.push(n)}}for(var c in t)if(t.hasOwnProperty(c)){var f=new hex.Control(t[c]);o.controls.push(f),o.form.controls.push(f)}};i()},e}(hex||{}),hex=function(e){"use strict";return e.Control=function(t){function r(e){return function(t,r){return"number"==typeof t[e]?t[e]-r[e]:t[e]<r[e]?-1:t[e]>r[e]?1:0}}function n(e){i.push(e);var t=h(e);for(var n in t)if(t.hasOwnProperty(n)){var o=n.match(/^data-hex-widget-(.*)$/i);if(null!==o&&void 0!==o[1]&&m(o[1],t[n]),"required"===n)p("required",t[n]);else{var d=n.match(/^data-hex-validator-(.*)$/i);null!==d&&void 0!==d[1]&&p(d[1],t[n])}}for(var u in f)f.hasOwnProperty(u)&&e.bind(u,v);l.sort(r("weight")),e.prop("disabled")&&a.disable(),e.prop("readonly")&&a.addReadonly(),e.bind("disable",function(){a.disable()}),e.bind("enable",function(){a.enable()}),s=a.getValue()}var a=this;a.type=void 0,a.valid=!0,a.name=void 0;var i=[];a.block=void 0;var o,s,d=[];a.formGroup=void 0;var u,l=[],c={},f={};a.disabled=!1,a.readonly=!1,a.hideErrors=function(){d=[],void 0!==a.formGroup&&a.formGroup.removeClass("has-error"),void 0!==o&&o.find("span").removeClass("active")},a.showErrors=function(){if(void 0!==o)for(var e in d)o.find("span.error-"+d[e]).addClass("active");void 0!==a.formGroup&&a.formGroup.addClass("has-error")},a.reset=function(){a.trigger("change"),a.hideErrors()},a.getWidgets=function(){return c},a.getInputs=function(){return i},a.enable=function(){for(var e in i)i[e].prop("disabled",!1);a.disabled=!1},a.disable=function(){for(var e in i)i[e].prop("disabled",!0);a.disabled=!0,a.valid=!0},a.addReadonly=function(){for(var e in i)i[e].prop("readonly",!0);a.readonly=!0},a.removeReadonly=function(){for(var e in i)i[e].prop("readonly",!1);a.readonly=!1};var v=function(e){if(e===!1)return a.valid;if(a.hideErrors(),!a.disabled)for(var t in l)if(l.hasOwnProperty(t)){var r=l[t],n=r.isValid(a.getValue());if(n===!1||"false"===n){d.push(r.getClassName());break}}return d.length>0?(a.valid=!1,a.showErrors()):(a.valid=!0,a.hideErrors()),void 0!==a.block.form.mainBlock&&a.block.form.mainBlock.isValid(!1),a.valid};a.isValid=function(e){return v(e)},a.trigger=function(e){for(var t=0;t<i.length;t++)i[t].trigger(e)},a.addEvent=function(e,t){for(var r=0;r<i.length;r++)i[r].bind(e,t)};var h=function(e){for(var t={},r=e[0].attributes,n=r.length,a=0;n>a;a++)t[r[a].name.toLowerCase()]=r[a].value;return t},p=function(t,r){var n={};if(t=e.utils.toCamel(t),void 0!==r&&""!==r&&$.extend(n,jQuery.parseJSON(r)),void 0!==e.validators[t]){var i=new e.validators[t](a,n),o=i.getEvents();for(var s in o)o.hasOwnProperty(s)&&(f[o[s]]=!0);l.push(i)}else console.warn('Validator "'+t+'" not loaded!')},m=function(t,r){t=e.utils.toCamel(t);var n={};void 0!==r&&""!==r&&$.extend(n,jQuery.parseJSON(r)),void 0!==e.widgets[t]?c[t]=new e.widgets[t](a,n):console.warn('Widget "'+t+'" not loaded!')};a.getValue=function(){switch(a.type){case"text":default:if(void 0!==c.date){var e=i[0].data("daterangepicker");if(void 0===e)return i[0].val();if(""===i[0].val())return!1;var t="",r="YYYY-MM-DD";if(e.timePicker===!0&&(r+=" HH:mm"),t+=e.startDate.format(r),e.singleDatePicker===!1){var n=e.endDate.format(r);t+=" - "+n}return t}return void 0!==c.fileupload||void 0!==c.filesimple?u:i[0].val();case"radio":for(var o in i)if(i.hasOwnProperty(o)&&i[o].is(":checked")===!0)return i[o].val();return!1;case"checkbox":return i[0].is(":checked")===!0?a.trueValue:a.falseValue}},a.setValue=function(e){u=e};var g=function(e){if(void 0!==e.type&&(a.type=e.type,"checkbox"===e.type&&(a.trueValue=!0,a.falseValue=!1,void 0!==e.trueValue&&(a.trueValue=e.trueValue),void 0!==e.falseValue&&(a.falseValue=e.falseValue))),void 0!==e.block&&(a.block=e.block),a.name=e.name,a.formGroup=e.formGroup,o=e.errorsBlock,void 0!==e.inputs)for(var t in e.inputs)e.inputs.hasOwnProperty(t)&&n(e.inputs[t]);a.hideErrors()};g(t)},e}(hex),hex=function(e){"use strict";return e.widgets.passwordShow=function(e){function t(){n=e.getInputs()[0],r=n.closest(".form-group").find("button.password-show"),r.bind("click",function(e){return e.preventDefault(),"password"===a?(n.attr("type","text"),r.addClass("active"),a="text"):(n.attr("type","password"),r.removeClass("active"),a="password"),n.focus(),!1})}var r,n,a="password";t()},e}(hex),hex=function(e){"use strict";return e.widgets.passwordStrength=function(e){function t(e){return o=e.length>8?1:0,s=e.match(c)?1:0,d=e.match(f)?1:0,u=e.match(v)?1:0,l=e.match(h)?1:0,o+s+d+u+l}function r(){n=e.getInputs()[0],a=n.closest(".form-group").find(".password-strength div"),n.bind("keyup change",function(){var e=n.val();a.attr("class","s-"+t(e))})}var n,a,i=this,o=0,s=0,d=0,u=0,l=0,c=new RegExp("[A-ZА-Я]"),f=new RegExp("[a-zа-я]"),v=new RegExp("[0-9]"),h=new RegExp("([!,%,&,@,#,$,^,*,?,_,~])");i.weight=0,r()},e}(hex),hex=function(e){"use strict";var t=$("html").attr("lang");if(e.utils.isEmpty(t))throw new Error("Doesn`t set lang attr in html tag");return moment.locale(t.toLowerCase()),e.widgets.date=function(t,r){function n(){a=t.getInputs()[0];var n=moment.localeData(),u=n.longDateFormat("L");void 0!==r.timePicker&&r.timePicker===!0&&(u+=" "+n.longDateFormat("LT"));var l={autoUpdateInput:!1,linkedCalendars:!1,singleDatePicker:!0,locale:{format:u,separator:" - ",applyLabel:"Готово",cancelLabel:"Отмена",fromLabel:"От",toLabel:"До",customRangeLabel:"Custom",daysOfWeek:moment.weekdaysShort(),monthNames:moment.months(),firstDay:n.firstDayOfWeek()}};void 0!==r.parentMin&&(s=$(r.parentMin).val(),e.utils.isEmpty(s)||(l.minDate=s),i=r.parentMin,delete r.parentMin),void 0!==r.parentMax&&(d=$(r.parentMax).val(),e.utils.isEmpty(d)||(l.maxDate=d),o=r.parentMax,delete r.parentMax),$.extend(l,r);var c=l.locale.format.replace(/[H]/g,"9").replace(/[m]/g,"9").replace(/[D]+/g,"d").replace(/[M]+/g,"m").replace(/[Y]+/g,"y");l.singleDatePicker===!1&&(c+=l.locale.separator+c),a.inputmask(c);var f=function(){var e=a.data("daterangepicker"),t=e.startDate.format(l.locale.format);l.singleDatePicker===!1&&(t+=l.locale.separator+e.endDate.format(l.locale.format)),a.val(t).trigger("change")};a.daterangepicker(l),a.on("apply.daterangepicker",function(){f()});var v=function(){d=$(o).val(),e.utils.isEmpty(d)?(t.disable(),a.val("").trigger("change")):(l.maxDate=d,a.daterangepicker(l),a.on("apply.daterangepicker",function(){f()}),t.enable(),e.utils.isEmpty(a.val())&&(e.utils.isEmpty(s)?(a.data("daterangepicker").setStartDate(d),a.data("daterangepicker").setEndDate(d)):(a.data("daterangepicker").setStartDate(s),a.data("daterangepicker").setEndDate(s))),f())},h=function(){s=$(i).val(),e.utils.isEmpty(s)?(t.disable(),a.val("").trigger("change")):(l.minDate=s,a.daterangepicker(l),a.on("apply.daterangepicker",function(){f()}),t.enable(),e.utils.isEmpty(a.val())&&(a.data("daterangepicker").setStartDate(s),a.data("daterangepicker").setEndDate(s)),f(),o!==!1&&v())};i!==!1&&$(i).on("change",function(){h()}),o!==!1&&$(o).on("change",function(){v()}),o!==!1&&v(),i!==!1&&h()}var a,i=!1,o=!1,s=!1,d=!1;n()},e}(hex),hex=function(e){"use strict";return e.widgets.mask=function(e,t){function r(){if(n=e.getInputs()[0],void 0===t.mask)throw new Error(n.attr("name")+" doesn`t set mask param");a=t.mask,n.inputmask(a)}var n,a;r()},e}(hex),hex=function(e){"use strict";return e.widgets.phone=function(e,t){function r(){n=e.getInputs()[0],void 0!==t.mask&&(a=t.mask),n.inputmask(a)}var n,a="+7(999)999-99-99";r()},e}(hex),hex=function(e){"use strict";return e.widgets.select2=function(t,r){function n(){a=t.getInputs()[0];var n=r.placeholder||"",o={theme:"bootstrap",allowClear:!0,placeholder:n,minimumResultsForSearch:10};if(void 0!==a.attr("multiple")&&(o.closeOnSelect=!1),void 0!==r.url){i="ajax";var s=a.find("option[selected]");if(r.ajax={url:r.url,method:"POST",dataType:"json",delay:250,data:function(e){return{search:e.term,page:e.page}},processResults:function(e,t){return t.page=t.page||1,{results:e.rows,pagination:{more:t.page*e.limit<e.total}}},cache:!0},delete r.url,void 0!==r.parent){var d=r.parent.selector,u=r.parent.param||"parent_id";e.utils.isEmpty($(d).val())&&(t.disable(),a.val("").trigger("change")),$(d).on("change",function(){e.utils.isEmpty($(this).val())?(t.disable(),a.val("").trigger("change")):(t.enable(),a.val("").trigger("change"))}),delete r.parent;var l=function(){return $(d).val()};r.ajax.data=function(e){var t={search:e.term,page:e.page};return t[u]=l,t}}}$.extend(o,r),a.select2(o),"ajax"===i&&(s.each(function(){a.append($(this))}),a.trigger("change"))}var a,i="local";n()},e}(hex),hex=function(e){"use strict";return e.widgets.filesimple=function(e){function t(){function t(t){n=t.target.files[0],e.setValue(n)}r=e.getInputs()[0],r.bind("change",t)}var r,n;t()},e}(hex),hex=function(e){"use strict";return e.widgets.fileupload=function(t,r){function n(){var e=[];for(var r in w)w[r].valid&&void 0!==w[r].id&&e.push(parseInt(w[r].id));t.setValue(e)}function a(){var e=!1;for(var t in w)if(w[t].loading===!0){e=!0;break}C.loading=e}function i(e,t){var r=y.clone();void 0!==t&&r.addClass(t),r.find("i").attr("title",e.name).html(e.name);var n=r.find(".upload-preview");return void 0!==e.url?(n.attr("href",e.url),void 0!==e.thumb&&n.html('<img src="'+e.thumb+'"/>')):n.hide(),r.get(0).outerHTML}function o(){var e="";for(var t in w)e+=i(w[t]);g.html(e),g.find("thumb").each(function(e){w[e].setElement($(this))})}function s(e){if(k){for(var t in w)w[t].remove(!0);g.find("thumb").remove(),n()}var r=new E({uid:e.uniqueIdentifier,name:e.name,loading:!0}),o=i(r,"upfile-new loading");g.append(o),r.setElement(g.find("thumb:last-child")),w.push(r),r.progress(5),a()}function d(e){for(var t=w.length,r=0;t>=r;r++)if(w[r].uid===e)return w[r];return!1}function u(e,t){var r=d(e.uniqueIdentifier);r!==!1&&r.error(t),a()}function l(e,t){var r=d(e.uniqueIdentifier);r!==!1&&r.complete(t),a()}function c(e){var t=Math.floor(e.size/100),r=Math.floor(e.sizeUploaded()/t),n=d(e.uniqueIdentifier);n!==!1&&n.progress(r)}function f(){var e=[];g.find("thumb").each(function(){var t=$(this).attr("id");for(var r in w)w[r].rid===t&&e.push(w[r])}),w=e,n()}function v(){if(h=t.getInputs()[0],b="u_"+h.attr("id")+"_",void 0!==r.types){x=[];var a=/$[\.]/;for(var i in r.types){var d=r.types[i];a.test(d)||(d="."+d),x.push(d)}}if(r.single===!0&&(k=!0),void 0===r.url)throw new Error("doesnt set url paremetr on "+t.name);p=r.url;var v={target:p,singleFile:k,simultaneousUploads:5,chunkSize:262144,maxChunkRetries:void 0,allowDuplicateUploads:!1,prioritizeFirstAndLastChunk:!0,generateUniqueIdentifier:function(t){var r="file_";return r+=t.size,r+=t.name,r+=b,r=e.utils.md5(r)}};if(m=new Flow(v),y=h.closest(".form-group").find(".upload-dropzone *").first().clone(!1),h.closest(".form-group").find(".upload-dropzone *").remove(),g=h.closest(".form-group").find(".upload-dropzone"),g.on("dragenter",function(){$(this).addClass("drag")}),g.on("dragover",function(){$(this).addClass("drag")}),g.on("dragend",function(){$(this).removeClass("drag")}),g.on("drop",function(){$(this).removeClass("drag")}),g.on("mouseout",function(){$(this).removeClass("drag")}),g.on("dragleave",function(){$(this).removeClass("drag")}),!k){var C=dragula([g[0]],{mirrorContainer:g.closest(".form-group")[0],direction:"horizontal",copy:!1,copySortSource:!1});C.on("drop",function(){f()})}var B=h.data("hexFiles");if(void 0!==B){for(var V in B){var D=new E(B[V]);w.push(D)}o()}if(n(),m.support){var S={};void 0!==x&&(S.accept=x.join(",")),m.assignBrowse(h.closest(".form-group").find("[data-upload]")[0],!1,k,S),m.assignDrop(g[0]),m.on("fileAdded",function(e){var t=!0;return void 0!==x&&x.indexOf("."+e.getType())<0&&(t=!1),t?s(e):(s(e),u(e,'"'+e.name+'" - неверный тип файла. Разрешены файлы типа: '+x.join(", "))),t}),m.on("fileSuccess",function(e,t){t=$.parseJSON(t),l(e,t)}),m.on("fileError",function(e,t){u(e,t)}),m.on("filesSubmitted",function(){m.upload()}),m.on("fileProgress",function(e){c(e)})}}var h,p,m,g,x,y,b,k=!1,w=[],C=this;C.loading=!1;var E=function(e){function t(){var e=b;void 0!==i.id&&(e+="_"+i.id),void 0!==i.uid&&(e+="_"+i.uid),i.rid=e,o.attr("id",e)}function r(e){if(void 0!==e)for(var t in e)i.hasOwnProperty(t)&&(i[t]=e[t]);void 0===i.id&&(i.valid=!1)}var i=this;i.id=void 0,i.uid=void 0,i.thumb=void 0,i.url=void 0,i.name=void 0,i.valid=!0,i.rid=0,i.loading=!1;var o;i.setElement=function(e){o=e,o.on("click","remove",function(e){return e.preventDefault(),i.remove(),!1}),t()},i.progress=function(e){i.valid=!1,o.find("p").show().css("width",e+"%")},i.complete=function(e){i.valid=!0,i.loading=!1,r(e),o.removeClass("loading");var t=o.find(".upload-preview");t.attr("href",i.url),t.show(),void 0!==i.thumb&&t.html('<img src="'+i.thumb+'"/>'),o.find("p").hide(),i.loading=!1,n()},i.remove=function(e){i.valid=!1,i.loading=!1;var t=w.indexOf(i);t>=0&&(C.uploaderRemoveFile(i.uid),w.splice(t,1)),e===!0?o.remove():o.fadeOut(function(){o.remove()}),a(),n()},i.error=function(e){i.valid=!1,i.loading=!1,o.find("p").hide(),o.removeClass("loading"),e="! Ошибка:<br/>"+e,o.find(".frame").html('<div class="upload-error">'+e+"</div>"),o.addClass("upfile-error"),o.removeClass("upfile-new");var t=w.indexOf(i);t>=0&&(C.uploaderRemoveFile(i.uid),w.splice(t,1))},r(e)};C.uploaderRemoveFile=function(e){var t=m.files;for(var r in t)if(t[r].uniqueIdentifier===e){m.removeFile(t[r]);break}},v()},e}(hex),hex=function(e){"use strict";return e.validators.required=function(t,r){function n(){void 0!==r.events&&a.setEvents(r.events)}var a=this,i=["blur","change","keyup"];a.weight=0;var o="required";a.getClassName=function(){return o},a.setEvents=function(e){i=e},a.getEvents=function(){return i},a.isValid=function(t){return!e.utils.isEmpty(t)},n()},e}(hex),hex=function(e){"use strict";return e.validators.email=function(t,r){function n(){void 0!==r.events&&a.setEvents(r.events)}var a=this,i="email";a.getClassName=function(){return i};var o=["change","keyup"],s=/^\S+[@]\S+\.\S{2,10}$/i;a.weight=1,a.setEvents=function(e){o=e},a.getEvents=function(){return o},a.isValid=function(t){return e.utils.isEmpty(t)?!0:s.test(t)},n()},e}(hex),hex=function(e){"use strict";return e.validators.unique=function(e,t){function r(){void 0!==t.events&&n.setEvents(t.events),void 0!==t.url&&(i=t.url)}var n=this,a="unique";n.getClassName=function(){return a};var i,o=!1,s=!1,d=["change","keyup","blur"];n.weight=5,n.setEvents=function(e){d=e},n.getEvents=function(){return d},n.isValid=function(e){if(s!==!1&&s.abort(),o!==e){s=$.ajax({url:i,data:{value:e},method:"POST",async:!1});var t=s.responseText;return o="true"===t?e:!1,t}return!0},r()},e}(hex),hex=function(e){"use strict";return e.validators.stringLength=function(e,t){function r(){void 0!==t.min&&(n=t.min),void 0!==t.max&&(a=t.max),void 0!==t.events&&i.setEvents(t.events)}var n,a,i=this,o="string-length";i.getClassName=function(){return o};var s=["change","keyup","blur"];i.weight=3,i.setEvents=function(e){s=e},i.getEvents=function(){return s},i.isValid=function(e){var t=e.length;return void 0!==n&&n>t?(o="string-length-min",!1):void 0!==a&&t>a?(o="string-length-max",!1):!0},r()},e}(hex),hex=function(e){"use strict";return e.validators.passwordConfirm=e.validators.confirm=function(e,t){function r(){void 0!==t.events&&n.setEvents(t.events),void 0!==t.password&&(o=$(t.password))}var n=this,a="password-confirm";n.getClassName=function(){return a};var i=["change","keyup","blur"];n.weight=4;var o;n.setEvents=function(e){i=e},n.getEvents=function(){return i},n.isValid=function(e){return o.val()===e},r()},e}(hex),hex=function(e){"use strict";return e.validators.mask=function(t,r){function n(){void 0!==r.events&&i.setEvents(r.events),a=t.getInputs()[0]}var a,i=this,o="mask",s=["blur"];i.getClassName=function(){return o},i.weight=4,i.setEvents=function(e){s=e},i.getEvents=function(){return s},i.isValid=function(t){if(e.utils.isEmpty(t))return!0;var r=a.inputmask("option","mask");return Inputmask.isValid(a.val(),{alias:r})},n()},e}(hex),hex=function(e){"use strict";return e.validators.phone=function(t,r){function n(){void 0!==r.events&&i.setEvents(r.events),a=t.getInputs()[0]}var a,i=this,o="phone",s=["blur"];i.getClassName=function(){return o},i.weight=4,i.setEvents=function(e){s=e},i.getEvents=function(){return s},i.isValid=function(t){if(e.utils.isEmpty(t))return!0;var r=a.inputmask("option","mask");return Inputmask.isValid(a.val(),{alias:r})},n()},e}(hex),hex=function(e){"use strict";return e.validators.date=function(t,r){function n(){void 0!==r.events&&a.setEvents(r.events),o=t.getInputs()[0]}var a=this,i=["change","keyup","blur"];a.weight=3;var o,s="date";a.getClassName=function(){return s},a.setEvents=function(e){i=e},a.getEvents=function(){return i},a.isValid=function(t){if(e.utils.isEmpty(t))return!0;var r=o.inputmask("option","mask");return Inputmask.isValid(o.val(),{alias:r})},n()},e}(hex),hex=function(e){"use strict";return e.validators.fileupload=function(e,t){function r(){void 0!==t.events&&n.setEvents(t.events)}var n=this,a="fileupload";n.getClassName=function(){return a};var i=[];n.setEvents=function(e){i=e},n.getEvents=function(){return i},n.isValid=function(){var t=e.getWidgets().fileupload;return void 0===t?!0:t.loading!==!0},r()},e}(hex),hex=function(e){"use strict";function t(t){function r(e){var t=o.mainBlock.findBlockById(e);if(t===!1)return!1;for(var r in t.controls){var n=t.controls[r],a=o.findControlByName(n.name);a!==!1&&o.controls.splice(o.controls.indexOf(a),1)}if(t.controls=[],t.element.remove(),void 0!==t.parent)for(var i in t.parent.childBlocks)t.parent.childBlocks[i]===t&&t.parent.childBlocks.splice(i,1);o.mainBlock.isValid(!1)}function n(e){function t(){n.isValid(!1);var t=s.getValue(),r=!1;null===t||t===!1||void 0===t||""===t||$.isArray(t)&&0===t.length?r=!1:("string"==typeof t&&t===i&&(r=!0),"object"==typeof t&&t.indexOf(i)>=0&&(r=!0)),r?(e.show(),e.find('input[type!="submit"],select,textarea').trigger("enable")):(e.hide(),e.find('input[type!="submit"],select,textarea').trigger("disable"))}if(e.parents('[data-hex-multy-item="$"]').size()>0)return!1;var r=e.closest("[data-hex-block]").attr("id"),n=o.mainBlock.findBlockById(r),a=e.data("hexDisabled"),i=a.value,s=o.findControlByName(a.control);if(void 0===s)throw new Error('Control "'+a.control+'" not found');s.addEvent("change",t),s.trigger("change")}function a(e){return e.replace("-","").toUpperCase()}function i(e){function t(e,t){o.hexBind(e,{"@index":t})}function a(){if(u===!1){var t=e.find("[data-hex-multy-item]");t.size()<=1?e.find("[data-hex-multy-remove]").attr("disabled","disabled"):e.find("[data-hex-multy-remove]").removeAttr("disabled")}}var i,s,d=e.data("hex-multy"),u=!1;void 0!==d.allow_empty&&d.allow_empty===!0&&(u=!0),e.find("[data-hex-multy-tabs]").size()>0&&(i=e.find("[data-hex-multy-tabs]"),s=i.find('[data-hex-multy-tab="$"]').clone(!1),i.find('[data-hex-multy-tab="$"]').remove());var l=e.find('[data-hex-multy-item="$"]'),c=l.clone(!1);l.remove(),e.on("click","[data-hex-multy-add]",function(){var r=e.find("[data-hex-multy-item]"),d=r.size(),u=c.clone(!1);u.find("[data-hex-multy-hide]").remove(),u.find("[data-hex-multy-attr]").each(function(){var e=$(this),t=e.data("hex-multy-attr");if(void 0!==t.add&&$.each(t.add,function(t,r){for(var n in r)e.attr(n,r[n])}),void 0!==t.remove)for(var r in t.remove)e.removeAttr(t.remove[r])});var l=e.find("[data-hex-multy-items]").closest("[data-hex-block]").attr("id"),f=o.mainBlock.findBlockById(l);if(void 0!==i){var v=s.clone(!1);e.find("[data-hex-multy-tab]:last").size()>0?v.insertAfter(e.find("[data-hex-multy-tab]:last")):i.prepend(v),t(v,d)}t(u,d),u.appendTo(e.find("[data-hex-multy-items]")),f.addBlock(u),void 0!==i&&$('a[href="#'+u.attr("id")+'"]').trigger("click"),u.find("[data-hex-disabled]").size()>0&&u.find("[data-hex-disabled]").each(function(){n($(this))}),a()}),e.on("click","[data-hex-multy-remove]",function(){var n=$(this).closest("[data-hex-multy-item]"),o=n.data("hexMultyItem");n.fadeOut(500,function(){r(n.attr("id"));var s=e.find("[data-hex-multy-item]");s.each(function(){$(this).data("hexMultyItem")>o&&t($(this),$(this).data("hexMultyItem")-1)}),void 0!==i&&(i.find('[data-hex-multy-tab="'+o+'"]').remove(),i.find("[data-hex-multy-tab]").each(function(){$(this).data("hexMultyTab")>o&&t($(this),$(this).data("hexMultyTab")-1)}),i.find("[data-hex-multy-tab="+o+"]").size()>0?i.find("[data-hex-multy-tab="+o+"]").find('a[role="tab"]').trigger("click"):i.find("[data-hex-multy-tab]:nth-child("+o+")").size()>0&&i.find("[data-hex-multy-tab]:nth-child("+o+")").find('a[role="tab"]').trigger("click")),a()})}),a()}var o=this;o.controls=[],o.errorText="Не удалось сохранить форму, попробуйте обновить страницу",o.invalidText="Форма содержит ошибки";var s=$("#"+t),d={};o.mainBlock=void 0;var u=function(e){this.type=e,this.stoped=!1,this.stop=function(){this.stoped=!0}};o.findControlByName=function(e){for(var t in o.controls)if(o.controls[t].name===e)return o.controls[t];return!1},o.on=function(e,t){void 0===d[e]&&(d[e]=[]),d[e].indexOf(t)<0&&d[e].push(t)},o.off=function(e,t){void 0!==d[e]&&d[e].splice(d[e].indexOf(t),1)},o.fire=function(e,t){if(void 0!==d[e]){var r=new u(e);for(var n in d[e]){var a=d[e][n];a(t,r)}return!r.stoped}return!0},o.getHandlers=function(){return d};var l=function(){var e={};for(var t in o.controls)if(o.controls.hasOwnProperty(t)&&o.controls[t].disabled===!1){var r=o.controls[t].name,n=o.controls[t].getValue();null===n||$.isArray(n)&&0===n.length?n="":e[r]=n}return e},c=function(e){var t=o.fire("beforeReset",{values:o.getValues()});t?window.setTimeout(function(){for(var e in o.controls)o.controls.hasOwnProperty(e)&&o.controls[e].reset();s.find(".has-error").removeClass("has-error"),s.find(".alerts .alert").remove()},1):e.preventDefault(),o.fire("afterReset",{})},f=function(){s.find(".has-error").removeClass("has-error"),s.find(".alerts div").remove()},v=function(e){e.preventDefault(),e.stopPropagation();var t=o.mainBlock.isValid();if(t===!0){f();var r=l(),n=o.fire("beforeSubmit",{values:r});if(n){o.loaderShow();var a=s.attr("action"),i=s.find("button[type=submit]:focus");i.size()>0&&void 0!==i.attr("data-action")&&(a=i.attr("data-action"));var d="POST";void 0!==s.attr("method")&&(d=s.attr("method"));var u=new FormData;$.each(r,function(e,t){if($.isArray(t)||$.isPlainObject(t))for(var r in t)null!==t[r]&&t[r]!==!1&&void 0!==t[r]&&u.append(e,t[r]);else u.append(e,t)}),$.ajax({url:a,data:u,type:d,dataType:"json",processData:!1,contentType:!1,success:function(e){var t=o.fire("afterSubmit",e);t&&window.setTimeout(function(){if(e.success===!0?(f(),void 0!==e.reload?e.reload===!0?window.location.href=window.location.href:window.location.href=e.reload:(o.loaderHide(),void 0!==e.newtab&&$(window).open(e.newtab,"_self"))):o.loaderHide(),void 0!==e.alerts){for(var t in e.alerts){var r=e.alerts[t];s.find(".alerts").append($("<div>").addClass("alert alert-"+r.type).html(r.text))}o.loaderHide()}},1)},error:function(){o.loaderHide(),s.find(".alerts").append($("<div>").addClass("alert alert-danger").html(o.errorText))}})}}else s.find(".alerts div").remove(),s.find(".alerts").append($("<div>").addClass("alert alert-danger").html(o.invalidText));return!1};o.loaderShow=function(){s.find(".loader").show()},o.loaderHide=function(){s.find(".loader").hide()},o.submit=function(){v()},o.getValues=function(){return l()},o.hexBind=function(e,t){function r(e){var t=e.split(""),r=[],n=[],a=0,i=!0;r[a]="";for(var o=0;o<t.length;o++)isNaN(parseInt(t[o]))&&"."!==t[o]&&!i?(n[a]=t[o],a++,r[a]="",i=!0):(r[a]+=t[o],i=!1);e=parseFloat(r[0]);for(var s=0;s<n.length;s++){var d=parseFloat(r[s+1]);switch(n[s]){case"+":e+=d;break;case"-":e-=d;break;case"*":e*=d;break;case"/":e/=d}}return e}function n(e){if("object"==typeof e)for(var a in e)e[a]=n(e[a]);else{for(var i in t)e=e.replace(new RegExp(i,"g"),t[i]);/\%/.test(e)&&(e=e.replace(/\%(.*?)\%/g,function(e){return r(e.replace(/\%/g,""))}))}return e}var i=[];i.push(e),e.find("[data-hex-bind]").each(function(){i.push($(this))});for(var s in i){var d=i[s].data("hexBind");for(var u in d){var l=n(d[u]);if("html"!==u){if(/^data/.test(u)){var c=u.replace(/^data-/,"");c=c.replace(/(\-[a-z])/g,a),i[s].data(c,l)}if("name"===u){var f=i[s].attr("name"),v=o.findControlByName(f);v!==!1&&(v.name=l)}if("id"===u&&0>=s){var h=o.mainBlock.findBlockById(i[s].attr("id"));h!==!1?h.id=l:console.log("block not found id:"+i[s].attr("id"))}"object"==typeof l?i[s].attr(u,JSON.stringify(l)):i[s].attr(u,l)}else i[s].html(l)}}};var h=function(){s.addClass("loader-container").append('<div class="loader"></div>'),s.attr("data-hex-block",""),s.on("submit",v),s.on("reset",c),0===s.find(".loader").size()&&s.append('<div class="loader"></div>'),o.mainBlock=new e.Block(s,o),s.find("[data-hex-multy]").size()>0&&s.find("[data-hex-multy]").each(function(){i($(this))}),s.find("[data-hex-disabled]").size()>0&&s.find("[data-hex-disabled]").each(function(){n($(this))})};return h(),o}var r={};return e.form=function(e){if(void 0!==e)return void 0===r[e]&&(r[e]=new t(e)),r[e];var n=$("form.hex-form");return n.each(function(){var e=$(this).attr("id");if(void 0===e)throw new Error("Form dont have id attr");void 0===r[e]&&(r[e]=new t(e))}),r},$(document).ready(function(){e.form()}),e}(hex);